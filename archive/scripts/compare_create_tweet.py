"""
成功時のcreate_tweet呼び出しと現在のcreate_tweet呼び出しを比較
"""
import sys
import io

# Windowsでの文字化け対策
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

print("=" * 80)
print("create_tweet呼び出しの比較")
print("=" * 80)
print()

print("[現在のコード]")
print("-" * 80)
print("ファイル: twitter_poster.py")
print("メソッド: post_tweet()")
print()
print("呼び出し:")
print("  response = self.client.create_tweet(text=text)")
print()
print("クライアントの初期化 (_create_client):")
print("  client = tweepy.Client(")
print("      bearer_token=self.credentials.get('bearer_token'),")
print("      consumer_key=self.credentials.get('api_key'),")
print("      consumer_secret=self.credentials.get('api_secret'),")
print("      access_token=self.credentials.get('access_token'),")
print("      access_token_secret=self.credentials.get('access_token_secret'),")
print("      wait_on_rate_limit=False  # レート制限時はエラーを返す（手動で処理）")
print("  )")
print()

print("[成功時のコード（推測）]")
print("-" * 80)
print("成功した投稿: 2026-01-04T15:52:59.459734 (365botGary)")
print("成功した投稿: 2026-01-04T15:42:28.719523 (pursahsgospel)")
print()
print("成功時のコードがどのようだったかを確認する必要があります。")
print()
print("確認事項:")
print("1. クライアントの初期化方法が同じか？")
print("   - wait_on_rate_limitパラメータが同じか？")
print("   - 認証情報の取得方法が同じか？")
print()
print("2. create_tweetの呼び出し方法が同じか？")
print("   - パラメータが同じか？")
print("   - textパラメータのみか？")
print()
print("3. エラーハンドリングが同じか？")
print("   - エラー処理の方法が同じか？")
print()

print("[現在のコードのcreate_tweet呼び出し箇所]")
print("-" * 80)
print()
print("1. twitter_poster.py - post_tweet()")
print("   response = self.client.create_tweet(text=text)")
print()
print("2. twitter_poster.py - post_tweet_with_link()")
print("   → post_tweet()を呼び出す")
print("   → 最終的に self.client.create_tweet(text=tweet_text) を呼び出す")
print()

print("[確認すべき違い]")
print("-" * 80)
print("1. wait_on_rate_limitパラメータ")
print("   - 現在: wait_on_rate_limit=False")
print("   - 成功時: 不明（確認が必要）")
print()
print("2. create_tweetの呼び出しパラメータ")
print("   - 現在: create_tweet(text=text)")
print("   - 成功時: 不明（確認が必要）")
print()
print("3. エラーハンドリング")
print("   - 現在: TooManyRequests例外をキャッチしてrecord_rate_limit_reasonを呼び出す")
print("   - 成功時: 不明（確認が必要）")
print()

print("=" * 80)

