# ローカルスケジューラー設定ガイド（Windowsタスクスケジューラ）

GitHub Actionsを使わず、ローカルPCでWindowsタスクスケジューラを使って自動投稿を実行する方法です。

## メリット

- ✅ セルフホストランナーの設定が不要
- ✅ CloudflareのIPブロックを回避（ローカルIPから実行）
- ✅ 設定が簡単
- ✅ PCが起動していれば自動実行

## 前提条件

- Windows 10/11
- Python 3.11がインストール済み
- プロジェクトディレクトリ: `C:\Users\kazz17\.cursor\blog-to-twitter-bot-temp`

## セットアップ手順

### ステップ1: バッチファイルを作成

`run_scheduled_post.bat` を作成：

```batch
@echo off
cd /d C:\Users\kazz17\.cursor\blog-to-twitter-bot-temp
python main.py
```

### ステップ2: Windowsタスクスケジューラでタスクを作成

1. **タスクスケジューラを開く**
   - Windowsキー + R → `taskschd.msc` → Enter

2. **基本タスクの作成**
   - 右側の「基本タスクの作成」をクリック
   - 名前: `Twitter自動投稿`
   - 説明: `ブログからTwitterへの自動投稿`

3. **トリガーの設定**
   - 「毎日」を選択
   - 開始: 希望する時刻（例: 8:00）
   - 繰り返し間隔: 6時間ごと（または希望する間隔）

4. **操作の設定**
   - 「プログラムの開始」を選択
   - プログラム/スクリプト: `C:\Users\kazz17\.cursor\blog-to-twitter-bot-temp\run_scheduled_post.bat`
   - 開始場所: `C:\Users\kazz17\.cursor\blog-to-twitter-bot-temp`

5. **条件の設定**
   - 「コンピューターがAC電源に接続されている場合のみタスクを開始する」のチェックを外す（PCがバッテリーでも実行）
   - 「コンピューターをスリープ状態から復帰させてこのタスクを実行する」にチェック（推奨）

6. **設定の確認**
   - 「タスクをすぐに実行する」にチェック（テスト用）
   - 「タスクが失敗した場合、再試行間隔を設定する」にチェック
   - 再試行間隔: 10分
   - 再試行回数: 3回

7. **完了**
   - 「完了」をクリック

### ステップ3: 複数のスケジュールを設定（オプション）

1日3回（8時、14時、20時）実行する場合：

1. 上記の手順で3つのタスクを作成
   - `Twitter自動投稿_8時`
   - `Twitter自動投稿_14時`
   - `Twitter自動投稿_20時`

2. 各タスクのトリガーを設定
   - 8時のタスク: 毎日 8:00
   - 14時のタスク: 毎日 14:00
   - 20時のタスク: 毎日 20:00

### ステップ4: テスト実行

1. タスクスケジューラで作成したタスクを右クリック
2. 「実行」を選択
3. ログを確認（`main.py`の出力を確認）

## ログの確認方法

### 方法1: バッチファイルにログ出力を追加

`run_scheduled_post.bat` を以下のように変更：

```batch
@echo off
cd /d C:\Users\kazz17\.cursor\blog-to-twitter-bot-temp
python main.py >> log.txt 2>&1
```

これで、`log.txt`にログが記録されます。

### 方法2: Pythonスクリプトでログファイルに出力

`main.py`で既にログが設定されている場合は、そのまま使用できます。

## トラブルシューティング

### タスクが実行されない

1. **タスクスケジューラの履歴を確認**
   - タスクを選択 → 「履歴」タブを確認
   - エラーメッセージを確認

2. **Pythonのパスを確認**
   - バッチファイルでPythonのフルパスを指定：
   ```batch
   C:\Python311\python.exe main.py
   ```

3. **作業ディレクトリを確認**
   - タスクの「操作」で「開始場所」が正しく設定されているか確認

### ログが出力されない

- バッチファイルにログ出力を追加（上記参照）
- タスクスケジューラの「全般」タブで「最上位の特権で実行する」にチェック

### PCがスリープ中に実行されない

- タスクの「条件」タブで「コンピューターをスリープ状態から復帰させてこのタスクを実行する」にチェック
- または、PCをスリープさせない設定にする

## メリット・デメリット

### メリット

- ✅ 設定が簡単
- ✅ CloudflareのIPブロックを回避
- ✅ GitHub Actionsの制限を受けない
- ✅ 無料

### デメリット

- ❌ PCが起動している必要がある
- ❌ PCがスリープしている場合は実行されない（設定で回避可能）
- ❌ 複数のPCで同期する必要がある場合は手動設定が必要

## 推奨設定

- **実行頻度**: 6時間ごと（1日4回）または8時間ごと（1日3回）
- **再試行**: 失敗時は10分後に3回まで再試行
- **ログ**: バッチファイルでログファイルに出力
- **スリープ**: PCをスリープ状態から復帰させて実行

